<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WebAR – ukázka s &lt;model-viewer&gt;</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    main { max-width: 1100px; margin: 0 auto; padding: 16px; }
    model-viewer { width: 100%; height: 70vh; background: #f6f6f6; border-radius: 14px; }
    .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-top: 10px; }
    .btn { appearance: none; border: none; padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600; box-shadow: 0 1px 3px rgba(0,0,0,.1); }
    .btn-primary { background: #111; color: white; }
    .btn-secondary { background: #eee; }
    .note { font-size: 14px; opacity: .8; }
  </style>
</head>
<body>
  <main>
    <model-viewer id="viewer"
      src="models/objekt.glb"
      ios-src="models/objekt.usdz"                 
      ar ar-modes="webxr scene-viewer quick-look"
      ar-scale="fixed"                               
      camera-controls                                 
      environment-image="neutral"                    
      poster="img/poster.jpg"                       
      exposure="1.0" shadow-intensity="1"           
      touch-action="pan-y"                           
      crossorigin="anonymous"                        
      loading="lazy">

      <button slot="ar-button" class="btn btn-primary">Zobrazit v AR</button>
      <div slot="poster" style="display:flex;align-items:center;justify-content:center;height:100%;">
        Načítám model…
      </div>
    </model-viewer>

    <div class="row">
      <button class="btn btn-secondary" id="btn-reset">Reset kamera</button>
      <span class="note">Gesty: pinch = zoom, drag = otočit, dva prsty = posun.</span>
    </div>

    <div class="row">
      <strong>Posun objektu:</strong>
      <button class="btn btn-secondary" id="pan-left">◀︎</button>
      <button class="btn btn-secondary" id="pan-right">▶︎</button>
      <button class="btn btn-secondary" id="pan-up">▲</button>
      <button class="btn btn-secondary" id="pan-down">▼</button>
      <button class="btn btn-secondary" id="pan-center">Center</button>
      <label class="note">krok <input id="pan-step" type="number" value="0.1" step="0.05" min="0.01" style="width:80px"> m</label>
    </div>

    <div class="row">
      <strong>Měřítko:</strong>
      <input type="range" id="scale-slider" min="0.1" max="2" step="0.1" value="1">
      <span id="scale-val">1.0×</span>
    </div>
  </main>

  <script>
    const viewer = document.getElementById('viewer');
    document.getElementById('btn-reset').addEventListener('click', () => viewer.resetTurntableRotation());

    // Posun objektu (camera-target)
    const stepInput = document.getElementById('pan-step');
    let target = {x: 0, y: 0, z: 0};
    function applyTarget(){
      viewer.setAttribute('camera-target', `${target.x}m ${target.y}m ${target.z}m`);
    }
    function nudge(dx=0, dy=0, dz=0){
      const s = parseFloat(stepInput.value) || 0.1;
      target.x += dx * s;
      target.y += dy * s;
      target.z += dz * s;
      applyTarget();
    }
    document.getElementById('pan-left').addEventListener('click', () => nudge(-1,0,0));
    document.getElementById('pan-right').addEventListener('click', () => nudge(1,0,0));
    document.getElementById('pan-up').addEventListener('click', () => nudge(0,1,0));
    document.getElementById('pan-down').addEventListener('click', () => nudge(0,-1,0));
    document.getElementById('pan-center').addEventListener('click', () => { target={x:0,y:0,z:0}; applyTarget(); });

    // Slider měřítka
    const slider = document.getElementById('scale-slider');
    const scaleVal = document.getElementById('scale-val');
    slider.addEventListener('input', () => {
      const s = slider.value;
      scaleVal.textContent = s+"×";
      viewer.setAttribute('scale', `${s} ${s} ${s}`);
    });
  </script>
</body>
</html>
